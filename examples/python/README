CALLING FPGALINK FROM PYTHON

The examples below assume your device is a 1200K Digilent Nexys2. For Atlys &
Nexys3, remove the "-p" option, replace "1443:0005" with "1443:0007" and choose
an appropriate CSVF file for your board.

  FPGALink Python Example Copyright (C) 2011-2012 Chris McClelland
	
  usage: fpgalink2.py [-h] [-p] [-s] -v <VID:PID> [-i <VID:PID>] [-x <xsvfFile>]
                      [-f <dataFile>]
	
  Load FX2 firmware, load the FPGA, interact with the FPGA.
	
  optional arguments:
    -h, --help     show this help message and exit
    -p             FPGA is powered from USB (Nexys2 only!)
    -s             scan the JTAG chain
    -v <VID:PID>   renumerated vendor and product ID of the FPGALink device
    -i <VID:PID>   initial vendor and product ID of the FPGALink device
    -x <xsvfFile>  SVF, XSVF or CSVF file to play into the JTAG chain
    -f <dataFile>  binary data to write to register 0

There are separate bindings for different Python versions:

  fpgalink2.py - Python 2.x
  fpgalink3.py - Python 3.x

Only fpgalink2.py is checked into GitHub; fpgalink3.py is autogenerated by the
../../release.sh script during preparation of the binary distribution.

NOTE: With Python 2.5 & 2.6 you will need to install the argparse module, thus:
  wget -qO- 'http://argparse.googlecode.com/files/argparse-1.2.1.tar.gz' | tar zxf -
  sudo cp argparse-1.2.1/argparse.py /usr/lib/python2.5/site-packages/


NONINTERACTIVE EXECUTION

Linux x64:
  dd of=/var/tmp/foo.dat if=/dev/urandom bs=65536 count=160
  LD_LIBRARY_PATH=../../lin.x64/rel ./fpgalink2.py \
    -i 1443:0005 -v 1443:0005 -p -s \
    -x ../../hdl/apps/makestuff/swled/cksum/vhdl/csvf/fx2all-nexys2-1200.csvf \
    -f /var/tmp/foo.dat

Linux x86:
  dd of=/var/tmp/foo.dat if=/dev/urandom bs=65536 count=160
  LD_LIBRARY_PATH=../../lin.x86/rel ./fpgalink2.py \
    -i 1443:0005 -v 1443:0005 -p -s \
    -x ../../hdl/apps/makestuff/swled/cksum/vhdl/csvf/fx2all-nexys2-1200.csvf \
    -f /var/tmp/foo.dat

Linux armel:
  dd of=/var/tmp/foo.dat if=/dev/urandom bs=65536 count=160
  LD_LIBRARY_PATH=../../lin.armel/rel ./fpgalink2.py \
    -i 1443:0005 -v 1443:0005 -p -s \
    -x ../../hdl/apps/makestuff/swled/cksum/vhdl/csvf/fx2all-nexys2-1200.csvf \
    -f /var/tmp/foo.dat

Linux armhf:
  dd of=/var/tmp/foo.dat if=/dev/urandom bs=65536 count=160
  LD_LIBRARY_PATH=../../lin.armhf/rel ./fpgalink2.py \
    -i 1443:0005 -v 1443:0005 -p -s \
    -x ../../hdl/apps/makestuff/swled/cksum/vhdl/csvf/fx2all-nexys2-1200.csvf \
    -f /var/tmp/foo.dat

Linux ppc:
  dd of=/var/tmp/foo.dat if=/dev/urandom bs=65536 count=160
  LD_LIBRARY_PATH=../../lin.ppc/rel ./fpgalink2.py \
    -i 1443:0005 -v 1443:0005 -p -s \
    -x ../../hdl/apps/makestuff/swled/cksum/vhdl/csvf/fx2all-nexys2-1200.csvf \
    -f /var/tmp/foo.dat

MacOSX:
  dd of=/var/tmp/foo.dat if=/dev/urandom bs=65536 count=160
  DYLD_LIBRARY_PATH=../../osx/rel ./fpgalink2.py \
    -i 1443:0005 -v 1443:0005 -p -s \
    -x ../../hdl/apps/makestuff/swled/cksum/vhdl/csvf/fx2all-nexys2-1200.csvf \
    -f /var/tmp/foo.dat

Windows x64 (assuming you're running from http://bit.ly/makestuff):
  dd of=/var/tmp/foo.dat if=/dev/urandom bs=65536 count=160
  PATH=../../win.x64/rel:$PATH /c/Python27/python fpgalink2.py \
    -i 1443:0005 -v 1443:0005 -p -s \
    -x ../../hdl/apps/makestuff/swled/cksum/vhdl/csvf/fx2all-nexys2-1200.csvf \
    -f /var/tmp/foo.dat

Windows x86 (assuming you're running from http://bit.ly/makestuff):
  dd of=/var/tmp/foo.dat if=/dev/urandom bs=65536 count=160
  PATH=../../win.x86/rel:$PATH /c/Python27/python fpgalink2.py \
    -i 1443:0005 -v 1443:0005 -p -s \
    -x ../../hdl/apps/makestuff/swled/cksum/vhdl/csvf/fx2all-nexys2-1200.csvf \
    -f /var/tmp/foo.dat

This connects to the device at 1443:0005 (hopefully a 1200K Digilent Nexys2),
loads the onboard FX2LP chip with a new firmware, loads the cksum design into
the board's FPGA, and then does some register reads and writes. The changes to
the board are lost on the next power cycle, so it's safe to try.


INTERACTIVE EXECUTION

You can also use it in interactive mode (Linux x64):
  chris@linx64$ LD_LIBRARY_PATH=../../lin.x64/rel python
  Python 2.7.1+ (r271:86832, Apr 11 2011, 18:13:53)
  [GCC 4.5.2] on linux2
  Type "help", "copyright", "credits" or "license" for more information.
  >>> from fpgalink2 import *
  >>> flLoadStandardFirmware("1443:0005", "1D50:602B:0002", "D0234")
  >>> handle = flOpen("1D50:602B:0002")
  >>> flPortAccess(handle, 3, 0x80, 0x80, 0x80)
  >>> flPlayXSVF(
  ...   handle,
  ...   "../../hdl/apps/makestuff/swled/cksum/vhdl/csvf/fx2all-nexys2-1200.csvf"
  ... )
  >>> flWriteChannel(handle, 1000, 0x00, 0x10)
  >>> flReadChannel(handle, 1000, 0x00)
  >>> flClose(handle)
  >>> 
  chris@wotan$ 

And the same on Linux x86:
  chris@linx86$ LD_LIBRARY_PATH=../../lin.x86/rel python

And Linux armel:
  chris@linarmel$ LD_LIBRARY_PATH=../../lin.armel/rel python

And Linux armhf:
  chris@linarmhf$ LD_LIBRARY_PATH=../../lin.armhf/rel python

And Linux ppc:
  chris@linppc$ LD_LIBRARY_PATH=../../lin.ppc/rel python

And MacOS:
  chris@osx$ DYLD_LIBRARY_PATH=../../osx/rel python

And Windows x64 (assuming you're running from http://bit.ly/makestuff):
  chris@winx64$ PATH=../../win.x64/rel:$PATH /c/Python27/python

And Windows x86 (assuming you're running from http://bit.ly/makestuff):
  chris@winx86$ PATH=../../win.x86/rel:$PATH /c/Python27/python
